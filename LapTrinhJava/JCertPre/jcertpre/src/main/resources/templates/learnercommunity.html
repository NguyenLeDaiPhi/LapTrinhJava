<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Learner Community</title>
    <style>
        body { font-family: sans-serif; background-color: #f0f2f5; max-width: 900px; margin: auto; padding: 20px; }
        h1 { text-align: center; }
        .box { background: white; border-radius: 10px; padding: 20px; margin-bottom: 20px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
        input, textarea { width: 100%; padding: 10px; margin-top: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc; }
        button { background-color: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; }
        .comment { background: #f8f9fa; padding: 10px; margin-top: 10px; border-left: 3px solid #007bff; border-radius: 5px; }
        .author { color: #666; font-size: 0.9em; margin-top: 5px; }
    </style>
</head>
<body>
    <h1>Community Forum</h1>

    <!-- Learner chỉ xem bài viết -->
    <div th:each="post : ${posts}" class="box">
        <h3 th:text="${post.title}">Title</h3>
        <p th:text="${post.content}">Content</p>
        <p class="author" th:text="'By ' + ${post.authorName} + ' on ' + ${#temporals.format(post.postedAt, 'yyyy-MM-dd HH:mm')}"></p>

        <!-- Hiển thị bình luận -->
        <div>
            <strong>Comments:</strong>
            <div th:if="${postCommentsMap[post.id] != null}">
                <div th:each="comment : ${postCommentsMap[post.id]}" class="comment">
                    <p th:text="${comment.content}"></p>
                    <div class="author" th:text="'By ' + ${comment.authorName} + ' on ' + ${#temporals.format(comment.commentedAt, 'yyyy-MM-dd HH:mm')}"></div>
                </div>
            </div>
        </div>

        <!-- Gửi bình luận -->
        <form th:action="@{/learner/community/comment}" method="post">
            <input type="hidden" name="postId" th:value="${post.id}">
            <textarea name="content" rows="2" placeholder="Write a comment..." required></textarea>
            <button type="submit">Comment</button>
        </form>
    </div>
</body>
</html>
